<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.9/angular.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
    <link rel="stylesheet" href="/css/loginform.css">
    <title>Document</title>
</head>
<body ng-app="myApp" ng-controller="myCtrl1">
    <section class="form my-4 mx-5" >
        <div class="container">
            <div class="row1 row g-0 m-auto col-10">
                <div class="col-lg-5">
                    <img src="/Img/loginform.png" class="img-fluid h-100" alt="">
                </div>
                <div class="col-lg-5 mx-5 px-5 pt-5 login" id="login">
                    <img src="/Img/LogoAsus.png" width="100%" class="my-3" style="max-width: 300px;" alt="">
                    <h4>Sign into your account</h4>
                    <form name="myForm1">
                        <div class="form-row">
                            <div class="col-lg-12">
                                <input type="email" name="email" ng-model="email" placeholder="Email-Address" class="form-control my-4 p-3" required>
                                <span style="color:red" ng-show="myForm1.email.$touched && myForm1.email.$error.required">Email is required.</span>
                                <span style="color:red" ng-show="myForm1.email.$error.email">Invalid email address.</span>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="col-lg-12">
                                <input type="password" name="pass" ng-model="pass" placeholder="Password" class="form-control my-4 p-3" required>
                                <span style="color:red" ng-show="myForm1.pass.$touched && myForm1.pass.$error.required">Password is required.</span>
                            </div>
                        </div>
                        <div class="form-row pt-4">
                            <div class="col-lg-5">
                                <button ng-click="login()" type="button" class="btn1 mb-5" >Login</button>
                            </div>
                        </div>
                        <a href="#" onclick="forgot_password()">Forgot password ?</a>
                        <p>Don't have an account <a href="#" onclick="click_register()">Register here</a></p>
                        
                    </form>
                </div>
                <div class="col-lg-5 mx-5 px-5 pt-5 register" id="register">
                    <img src="/Img/LogoAsus.png" width="100%" class="my-3" style="max-width: 300px;" alt="">
                    <h4>Sign up</h4>
                    <form name="myForm2">
                        <div class="form-row">
                            <div class="col-lg-12">
                                <input type="text" name="user" ng-model="user.name" placeholder="User-Name" class="form-control my-4 p-3" required>
                                <span style="color:red" ng-show="myForm2.user.$touched && myForm2.user.$error.required">UserName is required.</span>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="col-lg-12">
                                <input type="text" name="birthday" ng-model="user.birthday" placeholder="Birthday" class="form-control my-4 p-3" required>
                                <span style="color:red" ng-show="myForm2.birthday.$touched && myForm2.birthday.$error.required">Birthday is required.</span><span style="color:red" ng-show="myForm2.birthday.$error.email">Invalid email address.</span>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="col-lg-12">
                                <input type="email" name="email" ng-model="user.email" placeholder="Email-Address" class="form-control my-4 p-3" required>
                                <span style="color:red" ng-show="myForm2.email.$touched && myForm2.email.$error.required">Email is required.</span>
                                <span style="color:red" ng-show="myForm2.email.$error.email">Invalid email address.</span>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="col-lg-12">
                                <input type="password" name="pass" ng-model="user.password" placeholder="Password" class="form-control my-4 p-3" required>
                                <span style="color:red" ng-show="myForm2.pass.$touched && myForm2.pass.$error.required">Password is required.</span>
                            </div>
                        </div>
                        <div class="form-row row">
                            <div class="col-lg-5">
                                <button ng-click="save()" type="button" class="btn-register btn1 mb-5" >Register</button>
                            </div>
                            <div class="col-lg-5">
                                <button type="button" class="btn-login btn2 mb-5" onclick="click_login()">Login</button>
                            </div>
                        </div>
                        
                    </form>
                </div>
                <div class="col-lg-5 mx-5 px-5 pt-5 recoverEmail" id="recoverEmail">
                    <img src="/Img/LogoAsus.png" width="100%" class="my-3" style="max-width: 300px;" alt="">
                    <h4>Change password</h4>
                    <form name="myForm3">
                        <div class="form-row">
                            <div class="col-lg-12">
                                <input type="email" name="email" ng-model="userChangePass.email" placeholder="Email-Address" class="form-control my-4 p-3" required>
                                <span style="color:red" ng-show="myForm3.email.$touched && myForm3.email.$error.required">Email is required.</span>
                                <span style="color:red" ng-show="myForm3.email.$error.email">Invalid email address.</span>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="col-lg-12">
                                <input type="password" name="pass" ng-model="userChangePass.password" placeholder="Password" class="form-control my-4 p-3" required>
                                <span style="color:red" ng-show="myForm3.pass.$touched && myForm3.pass.$error.required">Password is required.</span>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="col-lg-12">
                                <input type="password" name="enter_pass" ng-model="enter_pass" placeholder="Enter the password" class="form-control my-4 p-3" required>
                                <span style="color:red" ng-show="myForm3.enter_pass.$touched && myForm3.enter_pass.$error.required">Password is required.</span>
                                <span style="color:red" ng-if="userChangePass.password != enter_pass">Invalid password.</span>
                            </div>
                        </div>
                        <div class="form-row row pt-4">
                            <div class="col-lg-5">
                                <button ng-click="next()" type="button" class="btn1 mb-5" >Change</button>
                            </div>
                            <div class="col-lg-5">
                                <button onclick="prev_login()" type="button" class="btn2 mb-5" >Login</button>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </section>
    <script>
        function click_register(){
            document.getElementById("login").style.display="none";
            document.getElementById("register").style.display="block";
        }
        function click_login(){
            document.getElementById("login").style.display="block";
            document.getElementById("register").style.display="none";
        }
        function forgot_password(){
            document.getElementById("login").style.display="none";
            document.getElementById("recoverEmail").style.display="block";
        }
        function prev_login(){
            document.getElementById("login").style.display="block";
            document.getElementById("recoverEmail").style.display="none";
        }
        
    </script>
    <script>
        var app=angular.module("myApp",[]);
        app.controller("myCtrl1",function($scope,$http){
            $scope.user={};
            $scope.userChangePass={};
            $scope.listUser=[];
            $http.get("/js/user.json").then(function(response){
                $scope.listUser=response.data;
                console.log(response.data)
            });
            $scope.login=function(){
                var user=check_login($scope.email,$scope.pass)
                if (user) {
                    window.location="/html/home.html"
                }
                else{
                    alert('Login failed');
                }
            };
            function check_login(email,pass){
                for (var i = 0; i < $scope.listUser.length; i++) {
                    if($scope.listUser[i].email==email && $scope.listUser[i].password==pass){
                        return $scope.listUser[i];
                    }
                }
                return false;
            }
            $scope.save=function(){
                if ($scope.user.name==undefined || $scope.user.birthday==undefined || $scope.user.email==undefined || $scope.user.password==undefined) {
                   alert('Register failed')
                }
                else{
                    $scope.listUser.push(angular.copy($scope.user));
                    console.log($scope.listUser);
                    alert('Register successfully')
                    // document.getElementById("register").style.display="none";
                    // document.getElementById("login").style.display="block";
                    click_login();
                    
                }
                
            }
            function check_email(email){
                for (var i = 0; i < $scope.listUser.length; i++) {
                    if($scope.listUser[i].email==email){
                        $scope.listUser[i].email=$scope.userChangePass.email;
                        $scope.listUser[i].password=$scope.userChangePass.password;
                        return $scope.listUser[i];
                    }
                }
                return false;
            }
            $scope.next=function(){
                var user=check_email($scope.userChangePass.email);
                if(user && $scope.userChangePass.password==$scope.enter_pass){
                    alert('Password successfully changed');
                    document.getElementById("recoverEmail").style.display="none";
                    document.getElementById("login").style.display="block";
                    console.log($scope.listUser);
                }
                else{
                    alert('Password change failed');
                }
            }
        });
    </script>
</body>
</html>